<style>
  div img{
    position:absolute;
    height:90vh;
  }
  .show{
    display: none;
  }
  .hide{
    display: block;
  }
</style>
<body>
  フレームレート: <input id="frame_rate" type="text" value="1"/> 枚 / 秒
  <hr noshade="noshade"/>
  <div id="images">
    $$$image_tags$$$
  </div>
</body>
<script>
  const set_image = (fn)=>{
    const div = document.getElementById("images");
    const im = document.createElement( "img" );
    im.setAttribute( "src", "./sample_images/"+fn );
    div.appendChild(im);
  };
  const set_images = (a)=>{
    for( const im of a ){
      set_image(im);
    }
  };
  const progress_frame = (frame)=>{
    const div = document.getElementById("images");
    frame = (frame+1) % div.children.length;
    for( let f=0 ; f<div.children.length ; ++f ){
      const e = div.children[f];
      if (div.children.length-f<=frame ){
        e.classList.add("show");
        e.classList.remove("hide");
      } else {
        e.classList.remove("show");
        e.classList.add("hide");
      }
    }
    return frame;
  };
  
  let timer_id = null;

  const getPicIntervalMillisec = ()=>{
    let frame_rate = parseFloat(document.getElementById("frame_rate").value);
    if (!frame_rate || frame_rate<=0 ){
      return 1000;
    }
    return 1000/frame_rate;
  };

  const runAnimation = ()=>{
    let frame = 0;
    timer_id = setInterval( ()=>{
      frame = progress_frame(frame);
    }, getPicIntervalMillisec() );
  };

  const start = ()=>{
    t = document.getElementById("frame_rate");
    runAnimation();
    t.onchange = ()=>{
      if ( null !== timer_id ){
        clearInterval(timer_id);
        runAnimation();
      }
    }
  };
  start();
</script>

